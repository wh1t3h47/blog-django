{% extends 'base.html' %}

{% block content %}

<script>
    /** @type {'accordion' | 'cards'} */
    let listingType = '{{ category.listing_type | escapejs }}';

    const onChangeListingType = (newType) => {
        window.listingType = newType;
        const listingTypeInput = document.getElementById('id_listing_type');
        listingTypeInput.value = newType;
        if (newType === 'accordion') {
            document.getElementById('accordion-listing').checked = true;
            document.getElementById('cards-listing').checked = false;
            document.getElementById('single-listing').checked = false;
        } else if (newType === 'cards') {
            document.getElementById('cards-listing').checked = true;
            document.getElementById('accordion-listing').checked = false;
            document.getElementById('single-listing').checked = false;
        } else {
            document.getElementById('single-listing').checked = true;
            document.getElementById('accordion-listing').checked = false;
            document.getElementById('cards-listing').checked = false;
        }
    };
    const setAccordion = () => {
        onChangeListingType('accordion');
    };
    const setCards = () => {
        onChangeListingType('cards');
    };
    const setSingle = () => {
        onChangeListingType('single');
    };

    const isCheckedAccordion = () => {
        return window.listingType === 'accordion';
    };
    const isCheckedCards = () => {
        return window.listingType === 'cards';
    };
    const isCheckedSingle = () => {
        return window.listingType === 'single';
    };

    window.setAccordion = setAccordion;
    window.setCards = setCards;
    window.setSingle = setSingle;
    window.isCheckedAccordion = isCheckedAccordion;
    window.isCheckedCards = isCheckedCards;
    window.listingType = listingType;

    const oldWindowOnload = window.onload;
    window.onload = () => {
        if (window.listingType === 'accordion') {
            setAccordion();
        } else if (window.listingType === 'cards') {
            setCards();
        } else {
            setSingle();
        }
    };

</script>
<div style="display: flex; flex-direction: column; margin-top: 50px; margin-bottom: 20px;">
    <span style="display: flex; justify-content: space-between; align-items: center; width: 20%;">
        <label for="accordion-listing">Listagem em acordião?</label>
        <input type="checkbox" onchange="setAccordion();" id="accordion-listing"></input>
    </span>
    <span style="display: flex; justify-content: space-between; align-items: center; width: 20%;">
        <label for="cards-listing">Listagem em cartões?</label>
        <input type="checkbox" onchange="setCards();" id="cards-listing"></input>
    </span>
    <span style="display: flex; justify-content: space-between; align-items: center; width: 20%;">
        <label for="single-listing">Listar post único?</label>
        <input type="checkbox" onchange="setSingle();" id="single-listing"></input>
    </span>
</div>
<form id="post_form" method="post" action="" enctype="multipart/form-data">
    <div id="editor"></div>

    {% if not category.published %}
    <p>Categoria não publicada (não aparece no menu nem tem posts)</p>
    {% endif %}

    {% csrf_token %}
    {{ category_form.as_p }}
    <input type="submit" name="submit" value="Salvar" />
</form>
{% endblock %}